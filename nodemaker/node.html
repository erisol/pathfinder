<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../style/reset.css" />
<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
<title>Create nodes</title>
</head>
<body>
<div style="width: 2486px; height: 1092px;">

        <div style="float:left; width: 300px; height: 1092px; border-right: 3px solid #000; text-align: center;">
        
        <p><strong>Create nodes</strong>
        <br />
        </p>
        <p><br />
        Click on the map to the right to add a node.
        <br /><br />
        Coordinates:
        <span id="mouseCoords"></span>
        <br /><br />
        Node information:
        </p>
        <form name="storeCoords">
        <table width="295" border="0" cellspacing="0" cellpadding="0">
  <tr>
    <td>X:</td>
    <td><input name="xVal" type="text" maxlength="4" value="" /></td>
  </tr>
  <tr>
    <td>Y:</td>
    <td><input name="yVal" type="text" maxlength="4" value="" /></td>
  </tr>
  <tr>
    <td>Floor:</td>
    <td><input name="fVal" type="text" maxlength="1" value="5" /></td>
  </tr>
  <tr>
    <td></td>
    <td><input name="newNode" type="button" value="Add node" onclick="addNode()" /></td>
  </tr>
</table>
	</form>
    
    <br /><br />
    Nodes added:
    <span id="theNodes"><br /></span>
    <br /><br />
    
        </div>

        <div style="float:left;">
        <canvas id="makeNodeCanvas" width="2182" height="1092" style="background: url(../kart/kart_KE_5etg.jpg); left: 0;">
            <script>
      function getMousePos(canvas, evt) {
        var rect = canvas.getBoundingClientRect();
        return {
          x: evt.clientX - rect.left,
          y: evt.clientY - rect.top
        };
      }
      var canvas = document.getElementById('makeNodeCanvas');
      var context = canvas.getContext('2d');
	  
	  function writeMessage(message) {
		  
		  var messageCoords = document.getElementById("mouseCoords");
		  messageCoords.innerHTML = message;
		  
	  }
	
	  
      canvas.addEventListener('mousemove', function(evt) {
        var mousePos = getMousePos(canvas, evt);
        var message = mousePos.x + ',' + mousePos.y;
        writeMessage(message);
      }, false);
	  
	  canvas.addEventListener('click', function(evt) {
		 var xvalue = document.getElementsByName("xVal");
		 var yvalue = document.getElementsByName("yVal");
		 var mousePos = getMousePos(canvas, evt);
		 xvalue[0].value = mousePos.x;
		 yvalue[0].value = mousePos.y;
		 
		 var c=document.getElementById("makeNodeCanvas");
		 var ctx=c.getContext("2d");
		 ctx.fillStyle="#FF0000";
		 ctx.fillRect(mousePos.x-3,mousePos.y-3,6,6);
		 ctx.stroke();
		 
		 
	  }, false);
	  
	  
	  var array5Floor = [];
	  var nextId = 0;
	  
	  function addNode() {
		  var xvalue = document.getElementsByName("xVal")[0].value;
		  var yvalue = document.getElementsByName("yVal")[0].value;
		  var fvalue = document.getElementsByName("fVal")[0].value;
		  array5Floor[nextId] = xvalue +","+ yvalue +","+ fvalue;
		  displayNodes();
		  nextId++;
	  }
	  
	  var displayedNodes = [];
	  
	  function displayNodes() {
		  var nodesDisplayed = document.getElementById("theNodes");
		  var displayId = nextId+1;
		  nodesDisplayed.innerHTML += displayId+": "+ array5Floor[nextId].toString()+" <a href='#' onclick='removeNode("+nextId+")'>Remove this</a><br />";
	  }
    </script>
        </div>
</div>
</body>
</html>
